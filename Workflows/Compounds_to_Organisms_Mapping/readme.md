# Running the Compounds_to_Organisms_Mapping workflow

![overview](case_study2.png)

## Required installation

Please also make sure that when you install drax, you leave the environment with the default name: `drax_env`

## Executing workflow

To execute this workflow simply do `python Compounds_to_Organisms_Mapping.py -i input_folder -o output_folder -met metabolites.tsv -db kegg,rhea,biocyc,hmdb`.

The `input_folder` variable should be a folder with one or more protein sequences fastas. 
The `metabolites.tsv` contains a list of metabolites. Each line can contain either metabolites names or ChEBI IDs. This file would look something like this:

|  |  |
|  :-------------: | :-------------: |
| indole  | 35581 |
| 1-hexanol  | 87393 |



The `output_folder` will be the directory where this workflow outputs its analysis. This folder contains the following folders and files:
- `mantis_input.tsv` - tsv with fastas path to be used in Mantis
- `mantis_output` - Mantis annotations, generated by functionally annotated the fastas
- `drax_input` - DRAX's input tsv, containing the annotations from Mantis minus the annotations already in the CarveMe models
- `drax_output` - DRAX's output, i.e., data gathered on compounds,reactions, and proteins, as well as the corresponding graph in `.sif` format 
- `workflow_output` - the resulting network where metabolites are connected to the samples. This `.sif` file contains 3 columns, `SOURCE`,`INTERACTION`,`TARGET`. `SOURCE` AND `TARGET` can either be the `internal_id`s  of the components coming from DRAX or the sample names. Each compound is connected to a reaction through a `cr` edge (`compound->reaction`), each reaction is connected to a protein through a `rp` edge, and each protein is connected to a sample through a `ps` edge. A `Report.tsv` is also provided, containing in each row the sample ID, and in each column the metabolites that were linked to the samples. The values in this .tsv represent the number of reactions that connected the sample to the metabolite (through a metabolite-reaction-protein-sample connection).
- `console.out` - console output

You can also add the variable `database` and choose which database you want to collect data from. By default, all the databases are used (i.e., kegg,rhea,biocyc,hmdb).

